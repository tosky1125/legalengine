{"ast":null,"code":"var _jsxFileName = \"/home/jun/carillon_codestates/client/src/pages/ViewPage.js\";\n\n/* eslint-disable no-param-reassign */\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport queryString from 'query-string';\nimport * as Law from '../modules/Law';\nimport * as Related from '../modules/Related';\nimport * as Result from '../modules/Result';\nimport SideInfo from '../components/SideInfo';\nimport ArticleLink from '../components/ArticleLink';\nimport ConvertToPDF from '../components/ConvertToPDF';\nimport './ViewPage.css';\n\nfunction ViewPage(props) {\n  const [isLoaded, setisLoaded] = useState(false);\n  const {\n    match\n  } = props;\n  const [name] = useState(match.params.key); // 검색어 하이라이트\n\n  const changeStr = (str, keyword) => {\n    const bracket = new Set(['<', '>']);\n    let isOn = false;\n    const {\n      length\n    } = keyword;\n\n    for (let i = 0; i < str.length; i++) {\n      const keyCheck = str.slice(i, i + length);\n\n      if (bracket.has(str[i])) {\n        isOn = !isOn;\n      }\n\n      if (!isOn && keyCheck === keyword) {\n        const tmp1 = str.slice(0, i);\n        const tmp2 = str.slice(i + length, str.length);\n        str = `${tmp1}thishashkey${tmp2}`;\n      }\n    }\n\n    str = str.replace(/thishashkey/g, `<span class='keyword-highlight'>${keyword}</span>`);\n    return str;\n  }; // 요청 받은 쿼리에 따라 서버에 Post 요청\n\n\n  useEffect(() => {\n    const {\n      Law,\n      Related,\n      Result\n    } = props;\n    const {\n      lawNum,\n      enfDate,\n      keyword\n    } = queryString.parse(props.location.search);\n    const payload = {\n      lawNum,\n      enfDate\n    };\n    console.log(keyword);\n    console.log(lawNum, enfDate);\n    let url = `http://13.125.112.243/law/${encodeURIComponent(name)}?lawNum=${lawNum}&enfDate=${enfDate}`;\n\n    if (!lawNum) {\n      url = `http://13.125.112.243/law/${name}?enfDate=${enfDate}`;\n    }\n\n    axios.post(url, payload).then(data => {\n      Related(data.data.Related);\n      Law(data.data.Law);\n\n      if (keyword) {\n        Result(changeStr(data.data.Law.context, keyword));\n      } else {\n        Result(data.data.Law.context);\n      }\n\n      setisLoaded(true);\n    }).catch(err => {\n      if (err.res) {\n        console.log(err.res.data);\n        console.log(err.res.status);\n        console.log(err.res.headers);\n      } else if (err.req) {\n        console.log(err.req);\n      } else {\n        console.log('Error', err.message);\n      }\n\n      console.log(err.config);\n    });\n  }, []);\n\n  if (isLoaded === true) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"viewpage-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"viewpage-sideinfo-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(SideInfo, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"viewpage-articlelink-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ArticleLink, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(ConvertToPDF, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"loder-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"loader-message\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, \"Loading...\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"loader\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  })));\n}\n\nexport default connect(state => ({\n  Law: state.Law.Law,\n  Related: state.Related.Related,\n  Result: state.Result.Result\n}), dispatch => ({\n  Law: data => dispatch(Law.Law(data)),\n  Related: data => dispatch(Related.Related(data)),\n  Result: data => dispatch(Result.Result(data))\n}))(withRouter(ViewPage));","map":{"version":3,"sources":["/home/jun/carillon_codestates/client/src/pages/ViewPage.js"],"names":["React","useState","useEffect","axios","connect","withRouter","queryString","Law","Related","Result","SideInfo","ArticleLink","ConvertToPDF","ViewPage","props","isLoaded","setisLoaded","match","name","params","key","changeStr","str","keyword","bracket","Set","isOn","length","i","keyCheck","slice","has","tmp1","tmp2","replace","lawNum","enfDate","parse","location","search","payload","console","log","url","encodeURIComponent","post","then","data","context","catch","err","res","status","headers","req","message","config","state","dispatch"],"mappings":"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","sourcesContent":["/* eslint-disable no-param-reassign */\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport queryString from 'query-string';\nimport * as Law from '../modules/Law';\nimport * as Related from '../modules/Related';\nimport * as Result from '../modules/Result';\nimport SideInfo from '../components/SideInfo';\nimport ArticleLink from '../components/ArticleLink';\nimport ConvertToPDF from '../components/ConvertToPDF';\nimport './ViewPage.css';\n\nfunction ViewPage(props) {\n  const [isLoaded, setisLoaded] = useState(false);\n  const { match } = props;\n  const [name] = useState(match.params.key);\n\n  // 검색어 하이라이트\n  const changeStr = (str, keyword) => {\n    const bracket = new Set(['<', '>']);\n    let isOn = false;\n\n    const { length } = keyword;\n\n    for (let i = 0; i < str.length; i++) {\n      const keyCheck = str.slice(i, i + length);\n\n      if (bracket.has(str[i])) {\n        isOn = !isOn;\n      }\n      if (!isOn && keyCheck === keyword) {\n        const tmp1 = str.slice(0, i);\n        const tmp2 = str.slice(i + length, str.length);\n        str = `${tmp1}thishashkey${tmp2}`;\n      }\n    }\n\n    str = str.replace(\n      /thishashkey/g,\n      `<span class='keyword-highlight'>${keyword}</span>`,\n    );\n    return str;\n  };\n\n  // 요청 받은 쿼리에 따라 서버에 Post 요청\n  useEffect(() => {\n    const { Law, Related, Result } = props;\n    const { lawNum, enfDate, keyword } = queryString.parse(props.location.search);\n    const payload = { lawNum, enfDate };\n    console.log(keyword);\n    console.log(lawNum, enfDate);\n\n    let url = `http://13.125.112.243/law/${encodeURIComponent(\n      name,\n    )}?lawNum=${lawNum}&enfDate=${enfDate}`;\n    if (!lawNum) {\n      url = `http://13.125.112.243/law/${name}?enfDate=${enfDate}`;\n    }\n\n    axios\n      .post(url, payload)\n      .then((data) => {\n        Related(data.data.Related);\n        Law(data.data.Law);\n        if (keyword) {\n          Result(changeStr(data.data.Law.context, keyword));\n        } else {\n          Result(data.data.Law.context);\n        }\n        setisLoaded(true);\n      })\n      .catch((err) => {\n        if (err.res) {\n          console.log(err.res.data);\n          console.log(err.res.status);\n          console.log(err.res.headers);\n        } else if (err.req) {\n          console.log(err.req);\n        } else {\n          console.log('Error', err.message);\n        }\n        console.log(err.config);\n      });\n  }, []);\n\n  if (isLoaded === true) {\n    return (\n      <div className='viewpage-container'>\n        <div className='viewpage-sideinfo-container'>\n          <SideInfo />\n        </div>\n        <div className='viewpage-articlelink-container'>\n          <ArticleLink />\n        </div>\n        <ConvertToPDF />\n      </div>\n    );\n  }\n  return (\n    <div>\n      <div className='loder-container'>\n        <p className='loader-message'>Loading...</p>\n        <div className='loader' />\n      </div>\n    </div>\n  );\n}\n\nexport default connect(\n  (state) => ({\n    Law: state.Law.Law,\n    Related: state.Related.Related,\n    Result: state.Result.Result,\n  }),\n  (dispatch) => ({\n    Law: (data) => dispatch(Law.Law(data)),\n    Related: (data) => dispatch(Related.Related(data)),\n    Result: (data) => dispatch(Result.Result(data)),\n  }),\n)(withRouter(ViewPage));\n"]},"metadata":{},"sourceType":"module"}